<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Moto Świry Toruń</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
/* --- GLOBAL STYLE --- */
body {
  margin: 0;
  font-family: 'Arial', sans-serif;
  background: #0a0a0a;
  color: #eaeaea;
  overflow-x: hidden;
}

/* Animacja fade-in */
.fade-in {
  opacity: 0;
  transform: translateY(20px);
  animation: fadeIn 1s forwards;
}
@keyframes fadeIn {
  to { opacity: 1; transform: translateY(0); }
}

/* --- HEADER --- */
header {
  padding: 80px 20px;
  text-align: center;
  background: radial-gradient(circle, #1a0000, #000);
  border-bottom: 2px solid #ff2a2a;
  box-shadow: 0 0 25px #ff000055;
}

header h1 {
  font-size: 60px;
  font-weight: 900;
  color: #ff2a2a;
  text-shadow: 0 0 15px #ff0000, 0 0 30px #ff0000;
  letter-spacing: 3px;
  animation: neonPulse 2.5s infinite alternate;
}

@keyframes neonPulse {
  from { text-shadow: 0 0 10px #ff0000; }
  to { text-shadow: 0 0 25px #ff0000, 0 0 40px #ff0000; }
}

header p {
  font-size: 20px;
  opacity: 0.8;
}

/* --- SECTIONS --- */
section {
  padding: 60px 20px;
  max-width: 1200px;
  margin: auto;
}

h2 {
  color: #ff2a2a;
  text-shadow: 0 0 10px #ff000055;
}

/* --- MAP --- */
#map {
  height: 70vh;
  border-radius: 12px;
  box-shadow: 0 0 20px #ff000033;
}

/* --- BUTTONS --- */
button {
  background: #ff2a2a;
  border: none;
  color: white;
  padding: 12px 18px;
  margin: 6px;
  cursor: pointer;
  border-radius: 6px;
  transition: 0.3s;
  font-weight: bold;
  letter-spacing: 1px;
}

button:hover {
  background: #ff4444;
  transform: scale(1.05);
  box-shadow: 0 0 10px #ff0000;
}

/* --- TABLES --- */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
  animation: fadeIn 1s forwards;
}

td, th {
  border: 1px solid #222;
  padding: 10px;
  text-align: center;
}

th {
  background: #1a1a1a;
  color: #ff2a2a;
}

/* Animacja pojawiania się sekcji */
section {
  opacity: 0;
  animation: fadeIn 1.2s forwards;
}
</style>
</head>

<body>

<header class="fade-in">
  <h1>Moto Świry Toruń</h1>
  <p>Planowanie tras • Społeczność • Pasja</p>
</header>

<section>
  <h2>Dlaczego motocykle?</h2>
  <p>
    Motocykl to wolność, adrenalina i pełne skupienie na drodze.
    Każda trasa to osobna historia, a każda przejażdżka to oderwanie się od codzienności.
  </p>
</section>

<section>
  <h2>Planowanie trasy</h2>
  <div id="map"></div>
  <p id="info">Kliknij dwa punkty na mapie</p>
  <button onclick="resetMap()">Wyczyść mapę</button>
  <button onclick="copyLink()">Kopiuj trasę do Google Maps</button>
</section>

<section>
  <h2>Marki i modele motocykli</h2>
  <div id="brands"></div>
  <div id="models"></div>
</section>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
/* --- MAPA POLSKI --- */
const map = L.map('map', {
  maxBounds: [
    [54.9, 13.5],  // północny zachód
    [48.8, 24.5]   // południowy wschód
  ],
  maxBoundsViscosity: 1.0
}).setView([52.0, 19.0], 6);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

let markers = [];
let routeLayer = null;
let googleLink = "";

/* --- KLIKANIE NA MAPIE --- */
map.on('click', async e => {
  if (markers.length === 2) resetMap();

  const marker = L.marker(e.latlng).addTo(map);
  markers.push(marker);

  if (markers.length === 2) {
    const p1 = markers[0].getLatLng();
    const p2 = markers[1].getLatLng();

    const url = `https://router.project-osrm.org/route/v1/driving/${p1.lng},${p1.lat};${p2.lng},${p2.lat}?overview=full&geometries=geojson`;
    const res = await fetch(url);
    const data = await res.json();

    routeLayer = L.geoJSON(data.routes[0].geometry).addTo(map);
    const km = (data.routes[0].distance / 1000).toFixed(1);
    document.getElementById("info").innerText = `Dystans: ${km} km`;

    googleLink = `https://www.google.com/maps/dir/${p1.lat},${p1.lng}/${p2.lat},${p2.lng}`;
  }
});

/* --- RESET MAPY --- */
function resetMap() {
  markers.forEach(m => map.removeLayer(m));
  markers = [];
  if (routeLayer) map.removeLayer(routeLayer);
  routeLayer = null;
  googleLink = "";
  document.getElementById("info").innerText = "Kliknij dwa punkty na mapie";
}

/* --- KOPIOWANIE LINKU --- */
function copyLink() {
  if (!googleLink) return alert("Najpierw wybierz trasę");
  navigator.clipboard.writeText(googleLink);
  alert("Link skopiowany!");
}

/* --- MARKI I MODELE --- */
fetch("data/motorcycles.json")
  .then(res => res.json())
  .then(data => {
    const brandsDiv = document.getElementById("brands");
    const modelsDiv = document.getElementById("models");

    Object.keys(data).forEach(brand => {
      const btn = document.createElement("button");
      btn.textContent = brand;
      btn.onclick = () => showBrand(brand);
      brandsDiv.appendChild(btn);
    });

    function showBrand(brand) {
      modelsDiv.innerHTML = `<h3>${brand}</h3>`;
      Object.keys(data[brand]).forEach(year => {
        let html = `<h4>${year}</h4><table>
          <tr><th>Model</th><th>Cena (PLN)</th></tr>`;

        data[brand][year].forEach(m => {
          html += `<tr>
            <td>${m.model}</td>
            <td>${m.price.min} – ${m.price.max}</td>
          </tr>`;
        });

        html += "</table>";
        modelsDiv.innerHTML += html;
      });
    }
  });
</script>

</body>
</html>
